Sommaire :
----------

I.   Introduction

II.  Prérequis
       - Teensy
       - Server web
       - Repo git

III. Réalisation
       - Ghost writer
       - Backdoor
       - Mailer

VI.  Conclusion



I. Introduction :
-----------------

C'est en remarquant qu'avec un peu de social engineering nous arrivions à connecter une clef usb sur une machine,
sans que l'utilisateur ne se soucis de rien, que nous avons eu l'idée de réaliser une attaque sur un port usb.
L'originalité de notre projet étant d'utiliser une clef usb afin d'émuler un clavier dans le but de véroler
l'ordinateur victime, comme s'il le faisait de lui même et cela preque instantanément.
Pour cela une clef usb nommé USB Rubber Ducky existe déjà. Cette clef usb exécute une suite de commandes en les tappant
comme si c'était un clavier, de manière très rapide.
Ce vecteur d'attaque permet de réaliser des actions sur un ordinateur lorsque l'on a accès à une machine non verrouillée.
Dès lors, nous avons décidé d'acheter le matèriel nécessaire pour reproduire ce type de clef usb afin de mettre en place
une attaque aboutissant à l'optention d'un shell root, sur la machine victime. 



II. Prérequis :
---------------

L'attaque décrite dans cet article nécessite l'utilisation d'une Teensy,
d'un serveur web et des codes sources disponible sur http://github.com/kashimsax/TeensyExploit.git
L'ensemble du matériel utilisé nous a coûté seulement une 20ène d'euro.

     1. La Teensy :
     --------------

     La Teensy est tout simplement un micro-controleur doté d'un port USB (cf: https://www.pjrc.com/teensy/).
     Lors du branchement, grâce à des bibliothèques, la Teensy possède la particularité d'émuler le protocole
     de connexion de certains périphériques USB.
     Pour les besoins de notre projet, nous avons choisis de faire passer notre Teensy pour un clavier.
     Cela nous permet ensuite de simuler l'écriture d'un texte par l'utilisateur de façon automatisé.

     2. Le serveur web :
     -------------------

     Au cours de ce projet est apparu la nécessité de récupérer des scripts à distance.
     Pour ce faire, nous avons utilisé un serveur web gratuit. De cette manière nous pouvons télécharger nos
     fichiers grâce à la commande `wget`.
     De plus, cela nous permet de mettre en place un client mail pour recevoir les informations des victimes.
     Nous ne traîterons pas la question de l'anonymat dans cet article, celui-ci étant fait pour démontrer
     la possibilité d'obtenir un shell root au travers de la Teensy.
     Elle reste cependant une part importante de l'attaque si vous souhaitez la réaliser en condition réelle.

     3. Repo git :
     -------------

     Sur le repo git se trouve l'ensemble des sources du projet.
     Le dossier TeensySoft contient la librairie émulant le clavier grâce à la Teensy, mais également les lignes
     de commande à executer lors de la connexion du périphérique (ghostkeyboard.c).
     Vous trouverez également les répertoires shAppend et phpMailer contenant respectivement un script shell 
     initialisant une backdoor ainsi qu'un script php pour l'envoie des données.
     Pour finir, le répertoire LogDecoder contient un programme C++ de convertion de données utilisateurs en texte 
     compréhensible.
     

III. Réalisation :
------------------





VI. Conclusion :
----------------
